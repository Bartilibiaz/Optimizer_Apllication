<!DOCTYPE html>
<html lang="pl" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimizer Loader</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <script>
        // Konfiguracja Tailwind CSS dla trybu ciemnego
        tailwind.config = {
            darkMode: 'class', // Włącza tryb ciemny oparty na klasie
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Cienie dla motywów kolorystycznych */
        .loader-shadow {
            box-shadow: 0 0 25px rgba(79, 70, 229, 0.5), 0 0 50px rgba(30, 64, 175, 0.3);
            transition: box-shadow 0.4s ease-in-out;
        }
        .shadow-green {
             box-shadow: 0 0 25px rgba(34, 197, 94, 0.5), 0 0 50px rgba(22, 101, 52, 0.3);
        }
        .shadow-purple {
            box-shadow: 0 0 25px rgba(168, 85, 247, 0.5), 0 0 50px rgba(126, 34, 206, 0.3);
        }
        .shadow-red {
            box-shadow: 0 0 25px rgba(239, 68, 68, 0.5), 0 0 50px rgba(153, 27, 27, 0.3);
        }
        /* Ukrywanie modalu */
        .modal.hidden {
            pointer-events: none;
        }
        /* Płynne przejścia dla elementów */
        #main-container, .modal-content, #main-icon, #select-mod-button, #progress-bar, #launch-button, .mod-choice-button, body, .main-view-container {
            transition: all 0.4s ease-in-out;
        }
        /* Animowany gradient dla napisu PREMIUM */
        .premium-gradient-text {
            background: linear-gradient(to right, #FBBF24, #FFFFFF, #FDE68A, #FBBF24);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
            animation: shimmer 3s linear infinite;
        }
        @keyframes shimmer {
            to {
                background-position: -200% center;
            }
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 flex items-center justify-center min-h-screen p-4 overflow-x-hidden">

    <button id="menu-button" class="fixed top-6 left-6 z-40 p-2 rounded-full text-gray-500 dark:text-gray-400 hover:text-black dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700/50 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-all duration-300">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
    </button>

    <div id="menu-overlay" class="fixed inset-0 bg-black bg-opacity-60 z-20 hidden opacity-0 transition-opacity duration-300"></div>

    <div id="side-menu" class="fixed top-0 left-0 h-full w-64 bg-white dark:bg-gray-800 shadow-2xl z-30 transform -translate-x-full transition-transform duration-300 ease-in-out p-6 flex flex-col">
        <div>
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-8">Menu</h2>
            <nav class="flex flex-col gap-6">
                <div>
                    <h3 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3">Loader</h3>
                    <a href="#" id="main-menu-button" class="flex items-center gap-3 text-gray-600 dark:text-gray-300 hover:text-black dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700/50 p-2 rounded-md transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z" /></svg>
                        <span>Główna</span>
                    </a>
                     <a href="#" id="mod-content-menu-button" class="hidden flex items-center gap-3 text-gray-600 dark:text-gray-300 hover:text-black dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700/50 p-2 rounded-md transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75a4.5 4.5 0 0 1-4.884 4.484c-1.076-.091-2.2-.223-3.328-.427a2.112 2.112 0 0 0-1.018.067c-.313.102-.6.28-.823.513l-1.89 2.158c-.324.368-.83.568-1.353.568h-.46a2.124 2.124 0 0 1-2.124-2.124v-.46c0-.523.2-1.033.568-1.353l2.158-1.89c.233-.223.41-.51.513-.823a2.112 2.112 0 0 0 .067-1.018c-.204-1.128-.336-2.252-.427-3.328a4.5 4.5 0 0 1 4.484-4.884 4.5 4.5 0 0 1 4.884 4.484Z" /></svg>
                        <span id="mod-content-menu-text">Zawartość Moda</span>
                    </a>
                    <a href="#" id="tutorial-menu-button" class="flex items-center gap-3 text-gray-600 dark:text-gray-300 hover:text-black dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700/50 p-2 rounded-md transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6-2.292m0 0A9.043 9.043 0 0 0 12 6.042Z" /></svg>
                        <span>Poradnik</span>
                    </a>
                </div>
                
                <div>
                    <h3 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3">Konto</h3>
                    <a href="#" id="profile-menu-button" class="flex items-center gap-3 text-gray-600 dark:text-gray-300 hover:text-black dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700/50 p-2 rounded-md transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" /></svg>
                        <span id="profile-menu-text">Profil</span>
                    </a>
                    <a href="#" id="friends-menu-button" class="hidden flex items-center gap-3 text-gray-600 dark:text-gray-300 hover:text-black dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700/50 p-2 rounded-md transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 0 0 3.75-5.462c.402-1.236.402-2.506 0-3.742L18 6.28M6 6.28 3 9c-1.121 1.24-1.121 3.27 0 4.508l3 3.22M12 12h.01M15 15h.01M9 15h.01" /></svg>
                        <span id="friends-menu-text">Znajomi</span>
                    </a>
                    <a href="#" id="settings-menu-button" class="flex items-center gap-3 text-gray-600 dark:text-gray-300 hover:text-black dark:hover:text-white hover:bg-gray-200 dark:hover:bg-gray-700/50 p-2 rounded-md transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.24-.438.613-.438.995s.145.755.438.995l1.003.827c.48.398.668 1.03.26 1.431l-1.296 2.247a1.125 1.125 0 0 1-1.37.49l-1.217-.456c-.355-.133-.75-.072-1.075-.124a6.57 6.57 0 0 1-.22.127c-.332.183-.582.495-.645.87l-.213 1.281c-.09.543-.56.94-1.11.94h-2.593c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.063-.374-.313-.686-.645-.87a6.52 6.52 0 0 1-.22-.127c-.324-.196-.72-.257-1.075-.124l-1.217.456a1.125 1.125 0 0 1-1.37-.49l-1.296-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.437-.995s-.145-.755-.437-.995l-1.004-.827a1.125 1.125 0 0 1-.26-1.431l1.296-2.247a1.125 1.125 0 0 1 1.37-.49l1.217.456c.355.133.75.072 1.075-.124.072-.044.146-.087.22-.127.332-.183.582-.495-.645-.87l.213-1.281z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" /></svg>
                        <span>Ustawienia</span>
                    </a>
                </div>
            </nav>
        </div>
        <div id="premium-menu-item" class="mt-auto">
             <a href="#" id="premium-menu-button" class="flex items-center gap-3 bg-gray-900 p-3 rounded-lg transition-transform hover:scale-105">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6 text-amber-400">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456Z" />
                </svg>
                <span class="premium-gradient-text">PREMIUM</span>
            </a>
        </div>
    </div>

    <div id="main-container" class="main-view-container relative w-full max-w-md bg-white dark:bg-gray-800 rounded-2xl p-8 border border-indigo-500/10 dark:border-indigo-500/30 loader-shadow text-center">
        <div class="flex justify-center items-center mb-4">
            <svg id="main-icon" class="w-12 h-12 text-indigo-500 dark:text-indigo-400 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.59 14.37a6 6 0 01-5.84 7.38v-4.82m5.84-2.56a6 6 0 016.38 6.38h-4.82m0-1.92v-4.82m0 0a6 6 0 01-6.38-6.38h4.82m6.38 0a6 6 0 01-7.38 5.84m-1.14 0a6 6 0 01-6.38-6.38m-4.82 0h4.82" />
            </svg>
            <h1 id="main-title" class="text-3xl font-bold text-gray-900 dark:text-white tracking-wider">Optimalizer Loader</h1>
        </div>
        <button id="select-mod-button" class="w-full bg-gray-100 dark:bg-gray-700/50 border border-gray-300 dark:border-gray-600 text-indigo-500 dark:text-indigo-300 font-semibold py-2 px-4 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 transition-all duration-300 mb-6 flex items-center justify-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5" />
            </svg>
            <span id="select-mod-button-text">Wybierz Moda</span>
        </button>
        <div id="status-container" class="h-6 mb-4">
            <p id="status-text" class="text-gray-500 dark:text-gray-400 transition-opacity duration-300">Gotowy do uruchomienia.</p>
        </div>
        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 mb-8 overflow-hidden border border-gray-300 dark:border-gray-600">
            <div id="progress-bar" class="bg-indigo-500 h-full rounded-full transition-all duration-500 ease-in-out" style="width: 0%"></div>
        </div>
        <button id="launch-button" class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50 transition-all duration-300 btn-glow disabled:bg-gray-500 disabled:cursor-not-allowed disabled:shadow-none">
            Uruchom
        </button>
        <div id="premium-features-unlocked" class="hidden mt-6 border-t border-gray-200 dark:border-gray-700 pt-4 space-y-3 text-left">
             <h4 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider text-center mb-2">Funkcje Premium</h4>
             <button class="w-full text-left p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg text-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-amber-500"><path stroke-linecap="round" stroke-linejoin="round" d="M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.475 2.118A2.25 2.25 0 0 0 1 18c0-1.381.54-2.67 1.443-3.642a3 3 0 0 0 4.043-4.043 3 3 0 0 1 4.043-4.043 3 3 0 0 0 4.043-4.043 3 3 0 0 1 4.043-4.043 2.25 2.25 0 0 0 2.118-2.475 3 3 0 0 0-1.128-5.78 2.25 2.25 0 0 1-2.118-2.475 2.25 2.25 0 0 0-4.5 0 2.25 2.25 0 0 1-2.475-2.118 3 3 0 0 0-5.78-1.128 2.25 2.25 0 0 1-2.118-2.475 2.25 2.25 0 0 0-4.5 0 2.25 2.25 0 0 1-2.475 2.118 3 3 0 0 0-1.128 5.78Z" /></svg>
                <span>Dostosuj zawartość moda</span>
            </button>
             <button class="w-full text-left p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg text-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-amber-500"><path stroke-linecap="round" stroke-linejoin="round" d="M14.25 6.087c0-.595.484-1.08 1.08-1.08h.36c.665 0 1.29.255 1.77.705a2.408 2.408 0 0 1 .705 1.77v.36c0 .595-.484 1.08-1.08 1.08h-.36a2.408 2.408 0 0 1-1.77-.705 2.408 2.408 0 0 1-.705-1.77v-.36ZM14.25 12a2.408 2.408 0 0 0-1.77-.705h-.36c-.595 0-1.08.484-1.08 1.08v.36c0 .665.255 1.29.705 1.77a2.408 2.408 0 0 0 1.77.705h.36c.595 0 1.08-.484 1.08-1.08v-.36a2.408 2.408 0 0 0-.705-1.77 2.408 2.408 0 0 0-1.77-.705Zm0 0-3 3m0 0-3 3m3-3-3-3m3 3 3 3" /></svg>
                <span>Dostęp do wersji Beta</span>
            </button>
        </div>
        <p id="version-text" class="text-xs text-gray-400 dark:text-gray-500 mt-6">Wersja 1.0.4</p>
    </div>
    
    <div id="profile-container" class="main-view-container hidden w-full max-w-md bg-white dark:bg-gray-800 rounded-2xl p-8 border border-gray-200 dark:border-gray-700 text-center">
        
        <div id="logged-in-view" class="hidden">
            <div class="flex flex-col items-center">
                <img id="profile-avatar" src="https://placehold.co/128x128/f3f4f6/111827?text=Avatar" alt="User Avatar" class="w-32 h-32 rounded-full mb-4 border-4 border-gray-200 dark:border-gray-700 transition-colors duration-300">
                <h2 id="profile-username" class="text-3xl font-bold text-gray-900 dark:text-white">Witaj, <span id="display-username">Gracz</span></h2>
                <p class="text-md text-gray-500 dark:text-gray-400">Status: <span id="premium-status" class="font-bold text-green-500">Standard</span></p>
            </div>
            
            <div class="my-8 border-t border-gray-200 dark:border-gray-700"></div>

            <div class="text-left">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Twoje Statystyki</h3>
                <div class="space-y-3 text-gray-700 dark:text-gray-300">
                    <div class="flex justify-between items-center"><span class="font-bold text-gray-900 dark:text-white">0</span><span>Użyte modyfikacje:</span></div>
                </div>
            </div>

            <div id="profile-customization" class="hidden my-8 border-t border-gray-200 dark:border-gray-700 pt-6 text-left">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4 text-center">Dostosuj obramówkę (Premium)</h3>
                <p class="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-3 text-center">Kolor obramówki awatara</p>
                <div class="flex justify-center gap-4">
                    <button class="color-swatch w-10 h-10 rounded-full bg-indigo-500 border-2 border-transparent hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white transition-transform" data-color="indigo"></button>
                    <button class="color-swatch w-10 h-10 rounded-full bg-green-500 border-2 border-transparent hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white transition-transform" data-color="green"></button>
                    <button class="color-swatch w-10 h-10 rounded-full bg-purple-500 border-2 border-transparent hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white transition-transform" data-color="purple"></button>
                    <button class="color-swatch w-10 h-10 rounded-full bg-red-500 border-2 border-transparent hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 focus:ring-white transition-transform" data-color="red"></button>
                </div>
            </div>

            <div class="my-8 border-t border-gray-200 dark:border-gray-700"></div>
            <button id="logout-button" class="w-full bg-red-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 transition-colors duration-300">
                Wyloguj się z Discord
            </button>
        </div>

        <div id="logged-out-view">
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">Połącz swoje konto</h2>
            <p class="text-gray-600 dark:text-gray-400 mb-8">Połącz się z Discord, aby zweryfikować status Premium i spersonalizować profil.</p>

            <a href="https://discord.com/oauth2/authorize?client_id=1421883621719019531&redirect_uri=https%3A%2F%2Ftwoj-api-url.com%2Fauth%2Fdiscord%2Fcallback&response_type=code&scope=identify%20email%20guilds.join" 
                class="w-full bg-[#5865F2] text-white font-bold py-3 px-4 rounded-lg hover:bg-[#4752C4] focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50 transition-colors duration-300 flex items-center justify-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 448 512" class="w-5 h-5">
                    <path d="M400 0H48C21.49 0 0 21.49 0 48v416c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V48c0-26.51-21.49-48-48-48zm-88 336h-80v-48h80c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-80V176c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v160H144c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h80v48h-80c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h80v48h-80c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h80c8.84 0 16-7.16 16-16v-16h80c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16z"/>
                </svg>
                <span>Połącz przez Discord</span>
            </a>

            <p id="error-message" class="mt-4 text-sm text-red-500 hidden">Wystąpił błąd weryfikacji. Spróbuj ponownie.</p>
        </div>
    </div>

    <div id="settings-container" class="main-view-container hidden w-full max-w-md bg-white dark:bg-gray-800 rounded-2xl p-8 border border-gray-200 dark:border-gray-700 text-left">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-8 text-center">Ustawienia</h2>
        
        <div class="space-y-6">
            <div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">Konto</h3>
                <label for="email-input" class="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-1">Adres e-mail</label>
                <input type="email" id="email-input" value="gracz@example.com" class="w-full bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
            </div>

            <div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">Wygląd</h3>
                <p class="block text-sm font-medium text-gray-600 dark:text-gray-400 mb-2">Motyw aplikacji</p>
                <div class="flex items-center gap-2 bg-gray-100 dark:bg-gray-900 p-1 rounded-lg">
                    <button id="light-theme-button" class="w-full py-2 px-4 rounded-md text-sm font-semibold transition-colors">Jasny</button>
                    <button id="dark-theme-button" class="w-full py-2 px-4 rounded-md text-sm font-semibold transition-colors">Ciemny</button>
                </div>
            </div>
        </div>
        
        <div class="my-8 border-t border-gray-200 dark:border-gray-700"></div>

        <button class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50 transition-colors duration-300">
            Zapisz zmiany
        </button>
    </div>

    <div id="tutorial-container" class="main-view-container hidden w-full max-w-md bg-white dark:bg-gray-800 rounded-2xl p-8 border border-gray-200 dark:border-gray-700 text-center">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-8">Poradnik</h2>
        <div class="space-y-4 text-left">
            <button data-tutorial="mod-usage" class="tutorial-option-button w-full flex justify-between items-center text-left p-4 bg-gray-100 dark:bg-gray-700/50 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                <span class="font-semibold text-gray-800 dark:text-gray-200">Obsługa Moda</span>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5 text-gray-500 dark:text-gray-400"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" /></svg>
            </button>
            <button data-tutorial="profile" class="tutorial-option-button w-full flex justify-between items-center text-left p-4 bg-gray-100 dark:bg-gray-700/50 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                <span class="font-semibold text-gray-800 dark:text-gray-200">Profil i Konto</span>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5 text-gray-500 dark:text-gray-400"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" /></svg>
            </button>
            <button data-tutorial="bypass" class="tutorial-option-button w-full flex justify-between items-center text-left p-4 bg-gray-100 dark:bg-gray-700/50 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                <span class="font-semibold text-gray-800 dark:text-gray-200">Metody Bypass</span>
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5 text-gray-500 dark:text-gray-400"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" /></svg>
            </button>
        </div>
    </div>

    <div id="premium-container" class="main-view-container hidden w-full max-w-4xl bg-white dark:bg-gray-800 rounded-2xl p-8 border border-gray-200 dark:border-gray-700 text-center">
        <h2 class="text-4xl font-bold text-gray-900 dark:text-white mb-2">Odblokuj <span class="premium-gradient-text">PREMIUM</span></h2>
        <p class="text-gray-600 dark:text-gray-400 mb-10">Zyskaj dostęp do ekskluzywnych funkcji i wspieraj rozwój projektu.</p>
        <div class="grid md:grid-cols-3 gap-8">
            <div class="flex flex-col p-6 bg-gray-100 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700">
                <h3 class="text-2xl font-semibold text-gray-900 dark:text-white mb-2">Miesięczny</h3>
                <p class="text-4xl font-extrabold text-indigo-600 mb-4">$4.99<span class="text-lg font-medium text-gray-500 dark:text-gray-400">/mies.</span></p>
                <ul class="text-left space-y-3 text-gray-700 dark:text-gray-300 flex-grow mb-8">
                    <li class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-green-500"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z" clip-rule="evenodd" /></svg>
                        <span>Pełny dostęp do modów</span>
                    </li>
                    <li class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-green-500"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z" clip-rule="evenodd" /></svg>
                        <span>Priorytetowe wsparcie</span>
                    </li>
                    <li class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-green-500"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z" clip-rule="evenodd" /></svg>
                        <span>Dostęp do wersji Beta</span>
                    </li>
                </ul>
                <button class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors">Wybierz Plan</button>
            </div>
            <div class="flex flex-col p-6 bg-white dark:bg-gray-700/50 rounded-lg border-4 border-amber-500 loader-shadow shadow-amber-500/50 relative">
                <div class="absolute top-0 right-0 bg-amber-500 text-gray-900 text-xs font-bold px-3 py-1 rounded-bl-lg">NAJLEPSZY WYBÓR</div>
                <h3 class="text-2xl font-semibold text-gray-900 dark:text-white mb-2">Półroczny</h3>
                <p class="text-4xl font-extrabold text-amber-500 mb-4">$24.99<span class="text-lg font-medium text-gray-500 dark:text-gray-400">/6 mies.</span></p>
                 <ul class="text-left space-y-3 text-gray-700 dark:text-gray-300 flex-grow mb-8">
                    <li class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-green-500"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z" clip-rule="evenodd" /></svg>
                        <span>Wszystko z planu Miesięcznego</span>
                    </li>
                    <li class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-green-500"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z" clip-rule="evenodd" /></svg>
                        <span>Ekskluzywna rola na Discord</span>
                    </li>
                    <li class="flex items-center gap-2">
                         <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-green-500"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z" clip-rule="evenodd" /></svg>
                        <span>20% oszczędności</span>
                    </li>
                </ul>
                <button class="w-full bg-amber-500 text-gray-900 font-bold py-3 px-4 rounded-lg hover:bg-amber-600 transition-colors">Wybierz Plan</button>
            </div>
            <div class="flex flex-col p-6 bg-gray-100 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700">
                <h3 class="text-2xl font-semibold text-gray-900 dark:text-white mb-2">Wieczysty</h3>
                <p class="text-4xl font-extrabold text-indigo-600 mb-4">$49.99<span class="text-lg font-medium text-gray-500 dark:text-gray-400">/na zawsze</span></p>
                <ul class="text-left space-y-3 text-gray-700 dark:text-gray-300 flex-grow mb-8">
                    <li class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-green-500"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z" clip-rule="evenodd" /></svg>
                        <span>Wszystko bez limitu czasu</span>
                    </li>
                    <li class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-green-500"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z" clip-rule="evenodd" /></svg>
                        <span>Dożywotnie aktualizacje</span>
                    </li>
                    <li class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 text-green-500"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z" clip-rule="evenodd" /></svg>
                        <span>Wczesny dostęp do wszystkich nowości</span>
                    </li>
                </ul>
                <button class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors">Wybierz Plan</button>
            </div>
        </div>
    </div>

    <div id="mod-select-modal" class="modal fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-70 z-50 hidden">
        <div class="modal-content bg-white dark:bg-gray-800 rounded-xl p-8 w-full max-w-md shadow-2xl relative">
            <button id="close-modal-button" class="absolute top-4 right-4 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" /></svg>
            </button>
            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-6 text-center">Wybierz Moda</h3>
            <div id="mod-choices-container" class="space-y-4">
                <button data-mod-id="mod1" data-mod-name="Bypass V2" class="mod-choice-button w-full text-left p-4 bg-gray-100 dark:bg-gray-700/50 rounded-lg text-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                    <span class="font-semibold">Bypass V2</span>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Najnowszy bypass, zalecany dla większości użytkowników.</p>
                </button>
                <button data-mod-id="mod2" data-mod-name="Fast Injector" class="mod-choice-button w-full text-left p-4 bg-gray-100 dark:bg-gray-700/50 rounded-lg text-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                    <span class="font-semibold">Fast Injector</span>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Szybka iniekcja, starszy, ale stabilny.</p>
                </button>
                <button data-mod-id="mod3" data-mod-name="Premium Beta" class="mod-choice-button w-full text-left p-4 bg-amber-100 dark:bg-amber-900/50 rounded-lg text-gray-800 dark:text-gray-200 border-2 border-amber-500 hover:bg-amber-200 dark:hover:bg-amber-800 transition-colors">
                    <div class="flex items-center gap-2">
                        <span class="font-semibold">Premium Beta</span>
                        <span class="text-xs font-bold text-gray-900 bg-amber-400 px-2 rounded-full">PREMIUM</span>
                    </div>
                    <p class="text-sm text-gray-700 dark:text-gray-300">Dla użytkowników z aktywną subskrypcją.</p>
                </button>
            </div>
            <p id="mod-select-error" class="text-red-500 text-sm mt-4 hidden">Proszę, wybierz moda, aby kontynuować.</p>
        </div>
    </div>

    <div id="mod-content-modal" class="modal fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-70 z-50 hidden">
        <div class="modal-content bg-white dark:bg-gray-800 rounded-xl p-8 w-full max-w-md shadow-2xl relative">
            <button id="close-content-modal-button" class="absolute top-4 right-4 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" /></svg>
            </button>
            <h3 id="mod-content-title" class="text-2xl font-bold text-gray-900 dark:text-white mb-6 text-center">Zawartość: Bypass V2</h3>
            <div id="mod-content-details" class="space-y-4 text-left">
                 <div class="p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg">
                    <h4 class="font-semibold text-gray-900 dark:text-white">Funkcja 1: Ulepszony Anti-Cheat</h4>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Najnowsze metody omijania detekcji.</p>
                </div>
                 <div class="p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg">
                    <h4 class="font-semibold text-gray-900 dark:text-white">Funkcja 2: Optymalizacja RAM</h4>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Zmniejszenie zużycia pamięci, poprawa FPS.</p>
                </div>
            </div>
            <div class="mt-6 border-t border-gray-200 dark:border-gray-700 pt-6">
                <button id="go-to-main-from-content" class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors">Wróć do Głównej</button>
            </div>
        </div>
    </div>

    <div id="tutorial-content-modal" class="modal fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-70 z-50 hidden">
        <div class="modal-content bg-white dark:bg-gray-800 rounded-xl p-8 w-full max-w-md shadow-2xl relative">
            <button id="close-tutorial-modal-button" class="absolute top-4 right-4 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-white">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" /></svg>
            </button>
            <h3 id="tutorial-content-title" class="text-2xl font-bold text-gray-900 dark:text-white mb-6 text-center"></h3>
            <div id="tutorial-content-details" class="space-y-4 text-left text-gray-700 dark:text-gray-300">
                </div>
            <div class="mt-6 border-t border-gray-200 dark:border-gray-700 pt-6">
                <button id="go-to-tutorial-menu" class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors">Wróć do Menu Poradnika</button>
            </div>
        </div>
    </div>

    <script>
        const body = document.body;
        const mainContainer = document.getElementById('main-container');
        const profileContainer = document.getElementById('profile-container');
        const settingsContainer = document.getElementById('settings-container');
        const tutorialContainer = document.getElementById('tutorial-container');
        const premiumContainer = document.getElementById('premium-container');
        
        const views = {
            'main': mainContainer,
            'profile': profileContainer,
            'settings': settingsContainer,
            'tutorial': tutorialContainer,
            'premium': premiumContainer
        };
        let currentView = 'main';

        // Elementy Menu
        const menuButton = document.getElementById('menu-button');
        const sideMenu = document.getElementById('side-menu');
        const menuOverlay = document.getElementById('menu-overlay');

        const mainButton = document.getElementById('main-menu-button');
        const profileButton = document.getElementById('profile-menu-button');
        const settingsButton = document.getElementById('settings-menu-button');
        const tutorialButton = document.getElementById('tutorial-menu-button');
        const premiumMenuButton = document.getElementById('premium-menu-button');

        // Elementy loadera
        const mainIcon = document.getElementById('main-icon');
        const mainTitle = document.getElementById('main-title');
        const selectModButton = document.getElementById('select-mod-button');
        const selectModButtonText = document.getElementById('select-mod-button-text');
        const launchButton = document.getElementById('launch-button');
        const progressBar = document.getElementById('progress-bar');
        const statusText = document.getElementById('status-text');
        const premiumFeaturesUnlocked = document.getElementById('premium-features-unlocked');

        // Elementy Modalu Wyboru Moda
        const modSelectModal = document.getElementById('mod-select-modal');
        const closeModalButton = document.getElementById('close-modal-button');
        const modChoiceButtons = document.querySelectorAll('.mod-choice-button');
        const modContentMenuButton = document.getElementById('mod-content-menu-button');
        const modContentMenuText = document.getElementById('mod-content-menu-text');

        // Elementy Modalu Zawartości Moda
        const modContentModal = document.getElementById('mod-content-modal');
        const closeContentModalButton = document.getElementById('close-content-modal-button');
        const modContentTitle = document.getElementById('mod-content-title');
        const modContentDetails = document.getElementById('mod-content-details');
        const goToMainFromContentButton = document.getElementById('go-to-main-from-content');

        // Elementy Ustawień
        const lightThemeButton = document.getElementById('light-theme-button');
        const darkThemeButton = document.getElementById('dark-theme-button');

        // Elementy Poradnika
        const tutorialOptionButtons = document.querySelectorAll('.tutorial-option-button');
        const tutorialContentModal = document.getElementById('tutorial-content-modal');
        const closeTutorialModalButton = document.getElementById('close-tutorial-modal-button');
        const tutorialContentTitle = document.getElementById('tutorial-content-title');
        const tutorialContentDetails = document.getElementById('tutorial-content-details');
        const goToTutorialMenu = document.getElementById('go-to-tutorial-menu');

        // --- FUNKCJE POMOCNICZE ---

        function showView(viewId) {
            if (currentView === viewId) return;

            // Ukryj bieżący widok
            if (views[currentView]) {
                views[currentView].classList.add('hidden');
            }
            
            // Pokaż nowy widok
            if (views[viewId]) {
                views[viewId].classList.remove('hidden');
                currentView = viewId;
            }
        }

        function toggleMenu() {
            const isMenuOpen = sideMenu.classList.contains('translate-x-0');
            if (isMenuOpen) {
                sideMenu.classList.add('-translate-x-full');
                sideMenu.classList.remove('translate-x-0');
                menuOverlay.classList.add('hidden', 'opacity-0');
                menuOverlay.classList.remove('opacity-100');
            } else {
                sideMenu.classList.remove('-translate-x-full');
                sideMenu.classList.add('translate-x-0');
                menuOverlay.classList.remove('hidden', 'opacity-0');
                // Dodaj klasę opacity-100 po krótkiej chwili, aby zadziałała animacja
                setTimeout(() => menuOverlay.classList.add('opacity-100'), 10);
            }
        }

        function activatePremium() {
            // Zmień ikonę i tytuł na zielony premium
            mainContainer.classList.add('shadow-green');
            mainContainer.classList.remove('loader-shadow');

            mainIcon.classList.remove('text-indigo-500', 'dark:text-indigo-400');
            mainIcon.classList.add('text-green-500', 'dark:text-green-400');

            progressBar.classList.remove('bg-indigo-500');
            progressBar.classList.add('bg-green-500');
            
            // Pokaż sekcję odblokowanych funkcji
            premiumFeaturesUnlocked.classList.remove('hidden');

            // Pokaż premium w menu bocznym
            premiumMenuButton.querySelector('.premium-gradient-text').textContent = 'AKTYWNE';
            premiumMenuButton.classList.remove('bg-gray-900');
            premiumMenuButton.classList.add('bg-green-800');
        }

        function deactivatePremium() {
            // Przywróć domyślne style
            mainContainer.classList.remove('shadow-green', 'shadow-purple', 'shadow-red');
            mainContainer.classList.add('loader-shadow');

            mainIcon.classList.remove('text-green-500', 'dark:text-green-400', 'text-purple-500', 'dark:text-purple-400', 'text-red-500', 'dark:text-red-400');
            mainIcon.classList.add('text-indigo-500', 'dark:text-indigo-400');

            progressBar.classList.remove('bg-green-500', 'bg-purple-500', 'bg-red-500');
            progressBar.classList.add('bg-indigo-500');
            
            premiumFeaturesUnlocked.classList.add('hidden');

             // Przywróć menu boczne
            premiumMenuButton.querySelector('.premium-gradient-text').textContent = 'PREMIUM';
            premiumMenuButton.classList.add('bg-gray-900');
            premiumMenuButton.classList.remove('bg-green-800');
        }

        function setLoaderColor(color, premium = true) {
            const colorMap = {
                'indigo': { class: 'loader-shadow', icon: 'text-indigo-500 dark:text-indigo-400', progress: 'bg-indigo-500' },
                'green': { class: 'shadow-green', icon: 'text-green-500 dark:text-green-400', progress: 'bg-green-500' },
                'purple': { class: 'shadow-purple', icon: 'text-purple-500 dark:text-purple-400', progress: 'bg-purple-500' },
                'red': { class: 'shadow-red', icon: 'text-red-500 dark:text-red-400', progress: 'bg-red-500' },
            };

            // Resetuj klasy cienia
            mainContainer.classList.remove('loader-shadow', 'shadow-green', 'shadow-purple', 'shadow-red');
            // Resetuj klasy ikony i paska postępu
            mainIcon.className = mainIcon.className.split(' ').filter(c => !c.startsWith('text-') || c.startsWith('text-gray')).join(' ');
            progressBar.className = progressBar.className.split(' ').filter(c => !c.startsWith('bg-')).join(' ');

            // Ustaw nowe klasy
            const newColor = colorMap[color];
            mainContainer.classList.add(newColor.class);
            mainIcon.classList.add(newColor.icon);
            progressBar.classList.add(newColor.progress);

            // Zmień kolor ramki w profilu (do implementacji)
            const avatar = document.getElementById('profile-avatar');
            avatar.className = avatar.className.split(' ').filter(c => !c.startsWith('border-')).join(' ');
            avatar.classList.add('border-4', `border-${color}-500`);

            // Włącz/wyłącz funkcje premium w zależności od flagi
            if (premium) {
                premiumFeaturesUnlocked.classList.remove('hidden');
            } else {
                premiumFeaturesUnlocked.classList.add('hidden');
            }
        }
        
        // --- FUNKCJE DLA WIDOKU PROFILU DISCORD ---
        const loggedInView = document.getElementById('logged-in-view');
        const loggedOutView = document.getElementById('logged-out-view');
        const displayUsername = document.getElementById('display-username');
        const premiumStatus = document.getElementById('premium-status');
        const profileAvatar = document.getElementById('profile-avatar');
        const logoutButton = document.getElementById('logout-button');
        const errorMessage = document.getElementById('error-message');
        const profileCustomization = document.getElementById('profile-customization');
        const colorSwatches = document.querySelectorAll('.color-swatch');


        function toggleDiscordStatus(isLoggedIn, userData = null) {
            if (isLoggedIn) {
                loggedOutView.classList.add('hidden');
                loggedInView.classList.remove('hidden');
                
                if (userData) {
                    displayUsername.textContent = userData.user || 'Gracz';
                    profileAvatar.src = userData.avatar_url || 'https://placehold.co/128x128/f3f4f6/111827?text=Avatar';
                    
                    // Ustaw status Premium
                    if (userData.isPremium) {
                        premiumStatus.textContent = 'Aktywny Premium';
                        premiumStatus.classList.remove('text-red-500');
                        premiumStatus.classList.add('text-green-500');
                        profileCustomization.classList.remove('hidden');
                        activatePremium(); // Ustaw też Premium w loaderze
                    } else {
                        premiumStatus.textContent = 'Standard';
                        premiumStatus.classList.remove('text-green-500');
                        premiumStatus.classList.add('text-red-500');
                        profileCustomization.classList.add('hidden');
                        deactivatePremium(); // Upewnij się, że nie ma premium w loaderze
                    }
                }

            } else {
                loggedInView.classList.add('hidden');
                loggedOutView.classList.remove('hidden');
                // Wyczyść ewentualne dane sesji
                sessionStorage.removeItem('discord_user');
                deactivatePremium();
            }
        }

        // --- NASŁUCHIWANIE ZDARZEŃ ---

        // Przycisk Menu
        menuButton.addEventListener('click', toggleMenu);
        menuOverlay.addEventListener('click', toggleMenu);

        // Nawigacja
        mainButton.addEventListener('click', (e) => { e.preventDefault(); showView('main'); toggleMenu(); });
        profileButton.addEventListener('click', (e) => { e.preventDefault(); showView('profile'); toggleMenu(); });
        settingsButton.addEventListener('click', (e) => { e.preventDefault(); showView('settings'); toggleMenu(); });
        tutorialButton.addEventListener('click', (e) => { e.preventDefault(); showView('tutorial'); toggleMenu(); });
        premiumMenuButton.addEventListener('click', (e) => { e.preventDefault(); showView('premium'); toggleMenu(); });

        // Wylogowanie z Profilu
        logoutButton.addEventListener('click', (e) => {
            e.preventDefault();
            toggleDiscordStatus(false);
            // Czyści parametry statusu z URL
            window.history.pushState({}, document.title, window.location.pathname);
        });
        
        // Zmiana koloru w profilu
        colorSwatches.forEach(swatch => {
            swatch.addEventListener('click', () => {
                const color = swatch.getAttribute('data-color');
                // Na potrzeby demo, premium jest aktywne, jeśli jesteśmy w widoku zalogowanym i Premium
                const isPremiumActive = !profileCustomization.classList.contains('hidden'); 
                if(isPremiumActive) {
                    setLoaderColor(color, true);
                    // Opcjonalnie: Zapisz wybrany kolor w LocalStorage
                }
            });
        });


        // Logika Modalu Wyboru Moda
        selectModButton.addEventListener('click', () => {
            modSelectModal.classList.remove('hidden');
        });

        closeModalButton.addEventListener('click', () => {
            modSelectModal.classList.add('hidden');
        });

        // Wybór Moda
        modChoiceButtons.forEach(button => {
            button.addEventListener('click', () => {
                const modName = button.getAttribute('data-mod-name');
                const isPremium = button.getAttribute('data-mod-id') === 'mod3';

                if (isPremium && premiumStatus.textContent !== 'Aktywny Premium') {
                    statusText.textContent = 'Błąd: Ten mod wymaga konta Premium!';
                    statusText.classList.remove('text-gray-500', 'dark:text-gray-400');
                    statusText.classList.add('text-red-500', 'dark:text-red-400');
                    setTimeout(() => {
                        statusText.textContent = 'Gotowy do uruchomienia.';
                        statusText.classList.add('text-gray-500', 'dark:text-gray-400');
                        statusText.classList.remove('text-red-500', 'dark:text-red-400');
                    }, 3000);
                    return;
                }

                selectModButtonText.textContent = modName;
                modContentMenuText.textContent = modName;
                modContentMenuButton.classList.remove('hidden');
                modSelectModal.classList.add('hidden');
            });
        });

        // Logika Modalu Zawartości Moda
        modContentMenuButton.addEventListener('click', (e) => {
             e.preventDefault();
             toggleMenu(); // Zamknij menu
             
             const modName = modContentMenuText.textContent;
             modContentTitle.textContent = 'Zawartość: ' + modName;
             
             // Dynamiczne ładowanie treści (demo)
             modContentDetails.innerHTML = `
                 <div class="p-3 bg-gray-100 dark:bg-gray-700/50 rounded-lg">
                    <h4 class="font-semibold text-gray-900 dark:text-white">Opis:</h4>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Szczegółowe funkcje i ustawienia dla moda <strong>${modName}</strong>.</p>
                </div>
             `;
             modContentModal.classList.remove('hidden');
        });

        closeContentModalButton.addEventListener('click', () => {
            modContentModal.classList.add('hidden');
        });

        goToMainFromContentButton.addEventListener('click', () => {
             modContentModal.classList.add('hidden');
             showView('main');
        });

        // Logika Poradnika
        const tutorialContents = {
            'mod-usage': {
                title: 'Jak używać moda',
                content: `
                    <p>1. Wybierz moda z listy. Zwróć uwagę na wymagania Premium.</p>
                    <p>2. Kliknij "Uruchom". Loader automatycznie zainstaluje pliki.</p>
                    <p>3. Po wczytaniu moda, gra zostanie uruchomiona. Możesz grać!</p>
                `
            },
             'profile': {
                title: 'Profil i weryfikacja',
                content: `
                    <p>1. Kliknij "Połącz przez Discord" w zakładce Profil.</p>
                    <p>2. Zostaniesz przekierowany na serwer. Potwierdź połączenie.</p>
                    <p>3. Po powrocie loader zweryfikuje Twój status Premium i odblokuje funkcje.</p>
                `
            },
             'bypass': {
                title: 'Metody Bypass',
                content: `
                    <p>Aktualnie używamy bezpiecznej metody omijania detekcji poprzez opóźnioną iniekcję.</p>
                    <p class="mt-3 text-red-500 font-semibold">Ostrzeżenie: Zawsze używaj modów na własne ryzyko. Unikaj korzystania z innych programów jednocześnie!</p>
                `
            },
        };

        tutorialOptionButtons.forEach(button => {
            button.addEventListener('click', () => {
                const tutorialId = button.getAttribute('data-tutorial');
                const content = tutorialContents[tutorialId];

                tutorialContentTitle.textContent = content.title;
                tutorialContentDetails.innerHTML = content.content;
                
                tutorialContentModal.classList.remove('hidden');
                showView('tutorial'); // Upewnij się, że widok tutorial jest widoczny, jeśli jeszcze nie jest
            });
        });

        closeTutorialModalButton.addEventListener('click', () => {
            tutorialContentModal.classList.add('hidden');
        });
        
        goToTutorialMenu.addEventListener('click', () => {
            tutorialContentModal.classList.add('hidden');
        });


        // Zmiana motywu
        function setTheme(theme) {
            if (theme === 'dark') {
                body.classList.add('dark');
                lightThemeButton.classList.remove('bg-gray-200');
                darkThemeButton.classList.add('bg-gray-800', 'text-white');
                darkThemeButton.classList.remove('text-gray-800');
            } else {
                body.classList.remove('dark');
                lightThemeButton.classList.add('bg-white', 'text-gray-900');
                lightThemeButton.classList.remove('text-gray-600');
                darkThemeButton.classList.remove('bg-gray-800', 'text-white');
                darkThemeButton.classList.add('text-gray-600');
            }
             // Zapisz wybór w Local Storage
            localStorage.setItem('theme', theme);
        }

        // Ładowanie motywu z Local Storage
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            setTheme(savedTheme);
        } else {
            setTheme('dark'); // Domyślny motyw
        }

        lightThemeButton.addEventListener('click', () => setTheme('light'));
        darkThemeButton.addEventListener('click', () => setTheme('dark'));


        // Logika paska ładowania
        const loadingSteps = [
            { message: "Inicjalizowanie połączenia...", progress: 5, delay: 500 },
            { message: "Weryfikacja licencji...", progress: 20, delay: 1000 },
            { message: "Pobieranie plików moda...", progress: 45, delay: 1500 },
            { message: `Iniekcja ${selectModButtonText.textContent}...`, progress: 70, delay: 1000 },
            { message: "Omijanie zabezpieczeń...", progress: 90, delay: 800 },
            { message: "Finalizowanie...", progress: 95, delay: 800 },
            { message: "Uruchamianie gry!", progress: 100, delay: 1200 }
        ];

        let currentStep = 0;

        function processStep() {
            if (currentStep >= loadingSteps.length) {
                launchButton.disabled = false;
                launchButton.textContent = "Uruchom ponownie";
                currentStep = 0; return;
            }

            const step = loadingSteps[currentStep];
            
            // Animacja zanikania statusu
            statusText.classList.add('opacity-0');
            setTimeout(() => {
                statusText.textContent = step.message;
                progressBar.style.width = `${step.progress}%`;
                statusText.classList.remove('opacity-0');
            }, 300);

            currentStep++;
            setTimeout(processStep, step.delay);
        }

        launchButton.addEventListener('click', () => {
            // Walidacja wyboru moda
            if (selectModButtonText.textContent === 'Wybierz Moda') {
                statusText.textContent = 'Proszę, najpierw wybierz moda!'; 
                statusText.classList.remove('text-gray-500', 'dark:text-gray-400');
                statusText.classList.add('text-red-500', 'dark:text-red-400');
                setTimeout(() => {
                    statusText.textContent = 'Gotowy do uruchomienia.';
                    statusText.classList.add('text-gray-500', 'dark:text-gray-400');
                    statusText.classList.remove('text-red-500', 'dark:text-red-400');
                }, 3000);
                return;
            }
            
            // Wysłanie wiadomości do WebView (jeśli aplikacja jest w kontenerze)
             if (window.chrome && window.chrome.webview) {
                try {
                    // Wysłanie nazwy moda do backendu/aplikacji natywnej
                    window.chrome.webview.postMessage(`startModDownload:${selectModButtonText.textContent}`);
                    console.log(`Sent: startModDownload:${selectModButtonText.textContent}`);
                } catch (err) {
                    console.warn('postMessage failed:', err);
                }
            }

            launchButton.disabled = true;
            launchButton.textContent = "Ładowanie...";
            progressBar.style.width = '0%';
            currentStep = 0;
            processStep();
        });


        // Sprawdzenie stanu po załadowaniu strony (po powrocie z Discorda)
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const status = params.get('status');
            const usernameFromURL = params.get('user');
            const errorMsg = params.get('msg');
            
            // Sprawdź, czy wrócono po autoryzacji
            if (status === 'role_success') {
                // Zakładamy, że po sukcesie uzytkownik jest Premium (rola została nadana)
                const userData = {
                    user: usernameFromURL,
                    isPremium: true,
                    // Używamy inicjału jako placeholder avatara
                    avatar_url: 'https://placehold.co/128x128/3b82f6/ffffff?text=' + (usernameFromURL ? usernameFromURL[0].toUpperCase() : 'G') 
                };
                
                toggleDiscordStatus(true, userData);
                
                // Pokaż komunikat w głównej zakładce
                 statusText.textContent = `Witaj, ${usernameFromURL}! Status Premium zweryfikowany.`;
                 statusText.classList.add('text-green-500', 'dark:text-green-400');
                 setTimeout(() => {
                    statusText.textContent = 'Gotowy do uruchomienia.';
                    statusText.classList.remove('text-green-500', 'dark:text-green-400');
                 }, 5000);
            
            } else if (status === 'role_error' || status === 'server_error' || errorMsg) {
                // Wystąpił błąd
                toggleDiscordStatus(false);
                if (errorMessage) {
                    errorMessage.textContent = 'Błąd weryfikacji: ' + (errorMsg ? decodeURIComponent(errorMsg).replace(/_/g, ' ') : 'Wystąpił nieznany błąd.');
                    errorMessage.classList.remove('hidden');
                }
                
                // Ukryj błąd po 5 sekundach i wyczyść URL
                setTimeout(() => {
                    errorMessage.classList.add('hidden');
                    window.history.pushState({}, document.title, window.location.pathname);
                }, 5000);

            } else {
                // Domyślne sprawdzenie (np. czy użytkownik jest już zalogowany)
                const storedUser = sessionStorage.getItem('discord_user');
                if (storedUser) {
                    toggleDiscordStatus(true, JSON.parse(storedUser));
                } else {
                    toggleDiscordStatus(false);
                }
            }
        });

    </script>
</body>
</html>
